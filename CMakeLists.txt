cmake_minimum_required(VERSION 3.0.0)

project(radpro)

set(CMAKE_C_STANDARD 99)

FILE(GLOB sources platform.io/src/*.c)
FILE(GLOB display_sources platform.io/src/display/*.c)
FILE(GLOB sdlsim_sources platform.io/src/sdlsim/*.c)
FILE(GLOB U8g2Sources platform.io/.pio/libdeps/fs2011-stm32f051c8/U8g2/src/clib/*.c)
FILE(GLOB mcumaxSources platform.io/lib/mcu-max/*.c)

add_definitions(-D SDLSIM)
add_definitions(-D TUBE_M4011)
add_definitions(-D TUBE_J305)
add_definitions(-D TUBE_HH614)
add_definitions(-D BATTERY_REMOVABLE)
add_definitions(-D KEYBOARD_5KEYS)
add_definitions(-D U8G2_WITHOUT_INTERSECTION)
add_definitions(-D U8G2_WITHOUT_CLIP_WINDOW_SUPPORT)
add_definitions(-D U8G2_WITHOUT_FONT_ROTATION)
add_definitions(-D U8G2_WITHOUT_UNICODE)
add_definitions(-D U8G2_NO_BALANCED_STR_WIDTH_CALCULATION)
add_definitions(-D SIMULATE_PULSES)
add_definitions(-D _CRT_SECURE_NO_WARNINGS)

find_package(SDL2 CONFIG REQUIRED)
find_path(SERCOMM_INCLUDE_DIR sercomm/sercomm.h)
find_library(SERCOMM_LIB sercomm.lib)

add_executable(radpro-mono ${sources} ${display_sources} ${sdlsim_sources} ${U8g2Sources} ${mcumaxSources})
target_compile_definitions(radpro-mono PUBLIC DISPLAY_128X64)
target_compile_definitions(radpro-mono PUBLIC DISPLAY_MONO)
target_include_directories(radpro-mono PRIVATE platform.io/.pio/libdeps/fs2011-stm32f051c8/U8g2/src platform.io/lib/mcu-max ${SERCOMM_INCLUDE_DIR})
target_link_libraries(radpro-mono PRIVATE SDL2::SDL2 SDL2::SDL2main ${SERCOMM_LIB})

add_executable(radpro-color ${sources} ${display_sources} ${sdlsim_sources} ${U8g2Sources} ${mcumaxSources})
target_compile_definitions(radpro-color PUBLIC DISPLAY_320X240)
target_compile_definitions(radpro-color PUBLIC DISPLAY_COLOR)
target_include_directories(radpro-color PRIVATE platform.io/.pio/libdeps/fs2011-stm32f051c8/U8g2/src platform.io/lib/mcu-max ${SERCOMM_INCLUDE_DIR})
target_link_libraries(radpro-color PRIVATE SDL2::SDL2 SDL2::SDL2main ${SERCOMM_LIB})
